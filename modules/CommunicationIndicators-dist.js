function DEBUG_ASSERT(e,...t){if(!e)throw t.reduce(((e,t)=>e+" "+t));return e}let LLKEYS=["mover","doer","influencer","responder","shaper","producer","contemplator"],CIKEYS=["acceptanceLevel","interactiveStyle","internalControl","intrusionLevel","projectiveLevel","susceptibilityToStress","learningPreferenceAuditory","learningPreferenceVisual","learningPreferencePhysical"];function getSortedScores(e){let t=[];for(let r of LLKEYS)DEBUG_ASSERT(e.hasOwnProperty(r),"Missing key",r),DEBUG_ASSERT("number"==typeof e[r],"Invalid type for",r,typeof e[r]),t.push([r,e[r]]);return t.sort(((e,t)=>e[1]<t[1]?-1:e[1]>t[1]?1:0)).reverse()}function createShorthandString(e){let t="";DEBUG_ASSERT("object"==typeof e,"sortedScores should be an array",e,typeof e);for(let r=0;r<e.length;r++){DEBUG_ASSERT("object"==typeof e[r],"sortedScores[",r,"] should be an array",r,e[r],typeof e[r]);let n=e[r][0];DEBUG_ASSERT("string"==typeof n,"sortedScores[",r,"][0] should be a string",n,typeof n),DEBUG_ASSERT(LLKEYS.includes(n),"sortedScores[",r,"][0] should be a Life Language in LLKEYS",n);let o=e[r][1];if(DEBUG_ASSERT("number"==typeof o,"sortedScores[",r,"][1] should should be a number",n,typeof n),0!=r){let n=e[r-1][1]-o;n>=5&&n<=10?t+="Â·":n>10&&(t+="-")}let l=n[0].toUpperCase();t+=o>=50?l:l.toLowerCase()}return t}Chart.register(ChartDataLabels);const CICOLORS={ACCEPTANCE_LEVEL:["#D93C4B","#8D181C"],INTERACTIVE_STYLE_INTROVERT:"#2E3192",INTERACTIVE_STYLE_BALANCED:["#2E3192","#ED1C24"],INTERACTIVE_STYLE_EXTROVERT:"#ED1C24",INTERNAL_CONTROL:["#F9A150","#C75B27"],INTRUSION_LEVEL:["#FCD72B","#DFB825"],PROJECTIVE_LEVEL:["#BCD630","#2E6933"],SUSCEPTIBILITY_TO_STRESS:["#89D0C3","#186C66"],LEARNING_PREFERENCE_AUDITORY:"#4472C4",LEARNING_PREFERENCE_PHYSICAL:"#FCD72B",LEARNING_PREFERENCE_VISUAL:"#C21E30"};function createCIColor(e,t,r){DEBUG_ASSERT("object"==typeof e,"ctx should be an object",typeof e),DEBUG_ASSERT("number"==typeof t,"nWidth should be a number",typeof t),DEBUG_ASSERT(Object.keys(CICOLORS).includes(r),"cCIC should be an entry in CICOLORS",r);let n=CICOLORS[r];if("string"==typeof n)return n;let o=e.createLinearGradient(0,0,t,0);return o.addColorStop(0,n[0]),o.addColorStop(1,n[1]),o}function createCIChart(e,t,r,n,o=!1){DEBUG_ASSERT("string"==typeof e,"elementId should be a string",typeof e);const l=document.getElementById(e);DEBUG_ASSERT("object"==typeof l,"Invalid elementId, did not return canvas",e),l.style.width="100%",l.style.height="100%",l.width=l.offsetWidth,l.height=l.offsetHeight,DEBUG_ASSERT("string"==typeof t,"cTitle is not a string",typeof t),DEBUG_ASSERT("number"==typeof r,"nDataValue is not a number",typeof r),DEBUG_ASSERT("string"==typeof n,"cCIC is not a string",typeof n);let a={responsive:!0,maintainAspectRatio:!1,indexAxis:"y",scales:{x:{min:0,max:100},y:{beginAtZero:!0}},plugins:{legend:!1}};return o&&(a.scales.x.reverse=!0),r&&(a.plugins.datalabels={anchor:o?"start":"end",align:o?"right":"left",formatter:Math.round,color:"white",font:{size:12,weight:"bold"}}),new Chart(l,{type:"bar",data:{labels:[""],datasets:[{label:t,data:[r],borderWidth:1,backgroundColor:createCIColor(l.getContext("2d"),l.offsetWidth,n),barThickness:15}]},options:a})}const LOW=33,MODERATE=50,HIGH=66;function evaluateCILevel(e,t=[LOW,HIGH],r=["LOW","MODERATE","HIGH"]){return DEBUG_ASSERT("object"==typeof t&&2==t.length),DEBUG_ASSERT("object"==typeof r&&3==r.length),e<=t[0]?r[0]:e>=t[1]?r[2]:r[1]}function acceptanceLevelContemplatorForensics(e){return e<=LOW?"<strong>C*</strong>":"c*"}function internalControlProducerForensics(e){return e>=HIGH?"<strong>p</strong>":e>LOW?"<strong>P</strong>":"p"}function internalControlContemplatorForensics(e){return e<=LOW?"<strong>C*</strong>":"c*"}function projectiveLevelShaperForensics(e){return e>=HIGH?"<strong>s</strong>":e>=LOW?"<strong>S</strong>":"s"}let forensicsTable={ACCEPTANCE_LEVEL:{mover:LOW,doer:HIGH,influencer:HIGH,responder:LOW,shaper:HIGH,producer:HIGH,contemplator:acceptanceLevelContemplatorForensics},INTERNAL_CONTROL:{mover:LOW,doer:HIGH,influencer:LOW,responder:LOW,shaper:HIGH,producer:internalControlProducerForensics,contemplator:internalControlContemplatorForensics},INTRUSION_LEVEL:{mover:LOW,doer:LOW,influencer:HIGH,responder:HIGH,shaper:HIGH,producer:MODERATE,contemplator:HIGH},PROJECTIVE_LEVEL:{mover:LOW,doer:HIGH,influencer:HIGH,responder:HIGH,shaper:projectiveLevelShaperForensics,producer:HIGH,contemplator:LOW}};function evaluateForensicLevel(e,t,r){DEBUG_ASSERT("string"==typeof e),DEBUG_ASSERT("string"==typeof t),DEBUG_ASSERT("number"==typeof r);let n=forensicsTable[e][t];return"function"==typeof n?n(r):n==LOW&&r<=LOW||n==MODERATE&&r>LOW&&r<HIGH||n==HIGH&&r>=HIGH?"<strong>"+t[0]+"</strong>":t[0].toLowerCase()}function interactiveStyleForensics(e,t){let r=e[0].toLowerCase();switch(e){case"mover":"B"==t&&(r=r.toUpperCase()),"E"!=t&&(r="<strong>"+r+"</strong>");break;case"doer":case"responder":case"contemplator":"I"==t&&(r="<strong>"+r.toUpperCase()+"</strong>");break;case"influencer":case"shaper":case"producer":"E"==t&&(r="<strong>"+r.toUpperCase()+"</strong>");break;default:DEBUG_ASSERT(!1,"Incorrect Life Language type",e)}return r}Chart.register(ChartDataLabels);export function displayCommunicationIndicators(e){let t=getSortedScores(e);document.getElementById("ciname").innerText=e.fullname,document.getElementById("cicorp").innerText=e.companyName,document.getElementById("cishorthand").innerText=createShorthandString(t);let r=e.showForensics;for(let e of document.getElementsByClassName("CIForensics"))e.hidden=!r;let n=e.acceptanceLevel;createCIChart("acceptanceLevelChart","Acceptance Level",n,"ACCEPTANCE_LEVEL"),document.getElementById("alstatus").innerText=evaluateCILevel(n,[LOW,HIGH],["LOW","MEDIUM","HIGH"]),document.getElementById("alscore").innerText=n;for(let e=0;e<t.length;e++){document.getElementById("alll"+e).innerHTML=evaluateForensicLevel("ACCEPTANCE_LEVEL",t[e][0],n)}let o=e.interactiveStyle,l=o[o.length-1];DEBUG_ASSERT("I"==l||"B"==l||"E"==l,"Interactive Style type must be I, B, or E",o),n=parseFloat(o),createCIChart("interactiveStyleIntrovertChart","Introvert","I"==l?n:0,"INTERACTIVE_STYLE_INTROVERT",!0),createCIChart("interactiveStyleBalancedChart","Balanced","B"==l?n:0,"INTERACTIVE_STYLE_BALANCED"),createCIChart("interactiveStyleExtrovertChart","Extrovert","E"==l?n:0,"INTERACTIVE_STYLE_EXTROVERT"),document.getElementById("isstatus").innerText=evaluateCILevel(n),document.getElementById("isscore").innerText=n;for(let e=0;e<t.length;e++){document.getElementById("isll"+e).innerHTML=interactiveStyleForensics(t[e][0],l)}n=e.internalControl,createCIChart("internalControlChart","Internal Control",n,"INTERNAL_CONTROL"),document.getElementById("icstatus").innerText=evaluateCILevel(n),document.getElementById("icscore").innerText=n;for(let e=0;e<t.length;e++){document.getElementById("icll"+e).innerHTML=evaluateForensicLevel("INTERNAL_CONTROL",t[e][0],n)}n=e.intrusionLevel,createCIChart("intrusionLevelChart","Intrustion Level",n,"INTRUSION_LEVEL"),document.getElementById("ilstatus").innerText=evaluateCILevel(n),document.getElementById("ilscore").innerText=n;for(let e=0;e<t.length;e++){document.getElementById("illl"+e).innerHTML=evaluateForensicLevel("INTRUSION_LEVEL",t[e][0],n)}n=e.projectiveLevel,createCIChart("projectiveLevelChart","Projective Level",n,"PROJECTIVE_LEVEL"),document.getElementById("plstatus").innerText=evaluateCILevel(n),document.getElementById("plscore").innerText=n;for(let e=0;e<t.length;e++){document.getElementById("plll"+e).innerHTML=evaluateForensicLevel("PROJECTIVE_LEVEL",t[e][0],n)}n=e.susceptibilityToStress,createCIChart("susceptiblityToStressChart","Susceptibility To Stress",n,"SUSCEPTIBILITY_TO_STRESS"),document.getElementById("ssstatus").innerText=evaluateCILevel(n),document.getElementById("ssscore").innerText=n,createCIChart("learningPreferenceAuditoryChart","Auditory",e.learningPreferenceAuditory,"LEARNING_PREFERENCE_AUDITORY"),createCIChart("learningPreferenceVisualChart","Visual",e.learningPreferenceVisual,"LEARNING_PREFERENCE_VISUAL"),createCIChart("learningPreferencePhysicalChart","Physical",e.learningPreferencePhysical,"LEARNING_PREFERENCE_PHYSICAL"),n=e.learningPreferenceAuditory,document.getElementById("lpstatus").innerText=evaluateCILevel(n),document.getElementById("lpscore").innerText=n,n=e.learningPreferenceVisual,document.getElementById("lpll2").innerText=evaluateCILevel(n),document.getElementById("lpll3").innerText=n,n=e.learningPreferencePhysical,document.getElementById("lpll5").innerText=evaluateCILevel(n),document.getElementById("lpll6").innerText=n,window.addEventListener("beforeprint",(e=>{let t=document.getElementsByClassName("PrintFull");for(let e=0;e<t.length;e++){const r=t.item(e);Chart.getChart(r).resize(1101,75)}t=document.getElementsByClassName("PrintOneThird");for(let e=0;e<t.length;e++){const r=t.item(e);Chart.getChart(r).resize(367,75)}})),window.addEventListener("afterprint",(e=>{for(let e in Chart.instances){Chart.instances[e].resize()}}))}